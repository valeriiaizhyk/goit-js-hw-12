{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.btn-load-more');\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst per_page = 40;\nlet page = 1;\nlet userSearch = '';\n\nform.addEventListener('submit', useSubmit);\nbtnLoadMore.addEventListener('click', useLoadMore);\n\nasync function useSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  gallery.innerHTML = '';\n  userSearch = form.search.value.trim();\n\n  btnLoadMore.classList.add('hide');\n  const images = await fetchImages();\n\n  if (images.hits.length === 0) {\n    iziToast.error({\n      position: 'topRight',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  } else if (images.hits.length < per_page) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    btnLoadMore.classList.remove('hide');\n  }\n\n  form.reset();\n  reproduceImages(images);\n}\n\nasync function useLoadMore() {\n  page += 1;\n\n  btnLoadMore.classList.add('hide');\n  const images = await fetchImages();\n\n  if (page >= Math.ceil(images.totalHits / per_page)) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    btnLoadMore.classList.remove('hide');\n  }\n\n  reproduceImages(images);\n  moveBoard();\n}\n\nasync function fetchImages() {\n  loader.classList.remove('hide');\n  try {\n    const images = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '41839077-17381d035cc7abc60580c609c',\n        q: userSearch,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: per_page,\n        page: page,\n      },\n    });\n    return images.data;\n  } catch (error) {\n    console.log(error.message);\n    iziToast.error({\n      position: 'topRight',\n      message: 'Sorry, service unavailable.',\n    });\n  } finally {\n    loader.classList.add('hide');\n  }\n}\n\nfunction reproduceImages(images) {\n  const markup = images.hits.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        html +\n        `<li class='gallery-item'>\n              <a class='gallery-link' href='${largeImageURL}'>\n                <img\n                    class='gallery-image'\n                    src='${webformatURL}'\n                    alt='${tags}'\n                    width='360'\n                    height='200'\n                    />\n              </a>\n              <ul class='gallery-statistic'>\n                  <li><p class='statistic'> ‚ù§Ô∏è Likes <span>${likes}</span></p></li>\n                  <li><p class='statistic'> üëÄ Views <span>${views}</span></p></li>\n                  <li><p class='statistic'> üó®Ô∏è Comments <span>${comments}</span></p></li>\n                  <li><p class='statistic'> üì© Downloads <span>${downloads}</span></p></li>\n              </ul>\n            </li>`\n      );\n    },\n    ''\n  );\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  modal.refresh();\n}\n\nfunction moveBoard() {\n  const board = document.querySelector('.gallery-item');\n  const domRect = board.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: domRect * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["form","gallery","loader","btnLoadMore","modal","SimpleLightbox","per_page","page","userSearch","useSubmit","useLoadMore","event","images","fetchImages","iziToast","reproduceImages","moveBoard","axios","error","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","domRect"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAW,GACjB,IAAIC,EAAO,EACPC,EAAa,GAEjBR,EAAK,iBAAiB,SAAUS,CAAS,EACzCN,EAAY,iBAAiB,QAASO,CAAW,EAEjD,eAAeD,EAAUE,EAAO,CAC9BA,EAAM,eAAc,EACpBJ,EAAO,EACPN,EAAQ,UAAY,GACpBO,EAAaR,EAAK,OAAO,MAAM,KAAI,EAEnCG,EAAY,UAAU,IAAI,MAAM,EAChC,MAAMS,EAAS,MAAMC,IAEjBD,EAAO,KAAK,SAAW,EACzBE,EAAS,MAAM,CACb,SAAU,WACV,QACE,0EACR,CAAK,EACQF,EAAO,KAAK,OAASN,EAC9BQ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,4DACf,CAAK,EAEDX,EAAY,UAAU,OAAO,MAAM,EAGrCH,EAAK,MAAK,EACVe,EAAgBH,CAAM,CACxB,CAEA,eAAeF,GAAc,CAC3BH,GAAQ,EAERJ,EAAY,UAAU,IAAI,MAAM,EAChC,MAAMS,EAAS,MAAMC,IAEjBN,GAAQ,KAAK,KAAKK,EAAO,UAAYN,CAAQ,EAC/CQ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,4DACf,CAAK,EAEDX,EAAY,UAAU,OAAO,MAAM,EAGrCY,EAAgBH,CAAM,EACtBI,GACF,CAEA,eAAeH,GAAc,CAC3BX,EAAO,UAAU,OAAO,MAAM,EAC9B,GAAI,CAYF,OAXe,MAAMe,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACN,IAAK,qCACL,EAAGT,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMC,CACP,CACP,CAAK,GACa,IACf,OAAQW,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,EACzBJ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,6BACf,CAAK,CACL,QAAY,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACH,CAEA,SAASa,EAAgBH,EAAQ,CAC/B,MAAMO,EAASP,EAAO,KAAK,OACzB,CACEQ,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAGtEP,EACA;AAAA,8CACsCE;AAAA;AAAA;AAAA,2BAGnBD;AAAA,2BACAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6DAMkCC;AAAA,6DACAC;AAAA,iEACIC;AAAA,iEACAC;AAAA;AAAA,mBAK7D,EACJ,EAEE1B,EAAQ,mBAAmB,YAAakB,CAAM,EAC9Cf,EAAM,QAAO,CACf,CAEA,SAASY,GAAY,CAEnB,MAAMY,EADQ,SAAS,cAAc,eAAe,EAC9B,sBAAqB,EAAG,OAE9C,OAAO,SAAS,CACd,IAAKA,EAAU,EACf,SAAU,QACd,CAAG,CACH"}